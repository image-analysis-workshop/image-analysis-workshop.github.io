<!DOCTYPE html>
<!--
    Plain-Academic by Vasilios Mavroudis
    Released under the Simplified BSD License/FreeBSD (2-clause) License.
    https://github.com/mavroudisv/plain-academic
-->

<html lang="en">
<head>

  <title>Image Analyisis workshop. University of Exeter, St. Luke's Campus, University of Exeter 2-16 of May 2023</title>
    <link rel="icon" type="image/x-icon" href="./favi.png">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <link href='https://fonts.googleapis.com/css?family=Oswald:700' rel='stylesheet' type='text/css'>
</head>
<body>


<!-- Navigation -->
	<nav class="navbar navbar-inverse navbar-static-top" role="navigation">
	  <div class="container">
		<div class="navbar-header">
		  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		  <ul class="nav navbar-nav">
				  <li><a href="../index.html">Home</a></li>
				  <li><a href="../program.html">Programme</a></li>
				  <li><a href="../imagej.html">Materials Image J</a></li> 
				  <li><a href="../qupath.html">Materials QuPath</a></li>
				  <li><a href="../speakers.html">Talks</a></li> 
		  </ul>
		</div>
	  </div>
	</nav>
  
  <!-- Page Content -->
    <div class="container">

        <div class="row">

            <!-- Entries Column -->
            <div class="col-md-8" style="height: 100vh;">
                
                <!-- Main Image -->
       
                <h1> 4. Quantitative measurements</h1>
                <div style="margin-top:3%; text-align:justify;">                
                <br>
                <a href="../imagej.html">Home</a> | <a href="ImageJ_pg3.html"> << Previous Page</a> | <a href="ImageJ_pg5.html"> Next Page >></a> 
                <br>

                  <h2> Learning Objectives</h2>
                  <ul>
                    <li>Image thresholding</li>
                    <li>Binary images</li>
                    <li>Particle counting</li>
                    <li>Optimising segmentation</li>
                    <ul>
                        <li>Binary operations</li>
                        <li>Image filtering</li>
                        <li>Watershedding</li>
                    </ul>
                    <li>Adding plugins to updates manager</li>
                    <li>Labelmap images</li>
                    <li>Labelmap analysis</li>
                  </ul>
                  <br>
                  <h2>Thesholding</h2>
                  <br>
                  <p>A key step in analysing images is the establishment of which pixels are part of something you're interested, and which are not. </p>
                  <p>The simplest way to do this is by thresholding. </p>
                  <p>This basically works on the principle that regions of interest will have higher fluorescence values.</p>

                  <b>Exercise 1: </b>Thresholding
                  <ul>
                    <li>Open the sample image "Blobs" using the search tool</li>
                    <li>Open the Threshold... tool</li>
                        <ul><li>Image > Adjust > Theshold</li></ul>
                    <li>This image does not have a Dark Background, so deselect this option</li>
                    <li>Manually adjust the threshold, making your desired signal appear red </li>
                    <li>Click "Apply"</li>
                    <li>This has created a binary mask of the thresholded regions</li>
                    <ul>
                        <li>Hover your cursor over the different areas of the image</li>
                        <li>Only two vales now exist, 0 and 255 i.e. yes (this is interesting) and no (this is not)</li>
                    </ul>
                </ul>
                <br>
                <p float="left">
                  <img src="../docs/assets/Images/ImageJ/Page 4/Threshold tool.png" width="32%" />
                  <img src="../docs/assets/Images/ImageJ/Page 4/Blobs threshold on.png" width="32%" />
                  <img src="../docs/assets/Images/ImageJ/Page 4/Blobs binary.png" width="32%" /> 
                </p><br>
                <ul>
                    <li>Thresholding can be performed automatically using a range of different algorithms (you can see these in the "Treshold" tool menu - the default is "Default")</li>
                    <li>Many of these exist</li>
                    <li>To help decide which is the most effective try "Auto Threshold" and for Method select "Try All" (don't forget to untick "White objects on a black background")</li>
                </ul>
                <br><img class="img-responsive" src="../docs/assets/Images/ImageJ/Page 4/Threshold Montage.jpg" alt=""><br>  
                <ul></ul>                

                <h2>Counting Objects</h2>
                <br>
                <p>Now that we have segmented our objects we'd like to know how many there are and what they're like</p>
                <b>Exercise 2:</b> Counting
                <ul>
                    <li>If you don't have a binary image open, then set a threshold on Blobs and Apply it to make one</li>
                    <li>Open Analyze Particles</li>
                    <ul><li>Analyze > Analyze Particles...</li></ul>
                    <li>This tool will allow you to count the segmented objects and filter based on size an circularity </li>
                    <li>You can filter based on size and circularity</li>
                    <li>Options exist to specify what output is wanted</li>
                    <li>Experiment with this a bit</li>
                    <mark><b>Note: </b>As with scale bars, if you decorate your image with the output here then it exists as an overlay and can be removed by "Remove Overlay". Alternativey, duplicate images before processing.</mark>
                    <li>See that one of the "Show" options is for a "Count Mask". Try this and have a look at the output by hovering your curser over the objects</li>
                    <ul><li>See that each object has a different value</li>
                        <li>This type of image is often called a "Label map" and can be useful when you want to keep track of measurements relating to a given individual object</li>
                    
                    </ul>
                </ul>
                <br>
                <p float="left">
                  <img src="../docs/assets/Images/ImageJ/Page 4/Analyze Particles.png" width="48%" />
                  <img src="../docs/assets/Images/ImageJ/Page 4/blobs- AP result.jpg" width="48%" />
                </p><br>
                <ul>
                    <li>This has worked reasonably well, but it could be better</li>
                    <li>There are crearly some blobs which are fused together</li>
                    <li>Techniques exist to help separate these, known as Watershedding</li>
                    <ul>
                        <li>The metaphor involves thinking about the image as a topographic map, with the segmented signal being valleys which get deeper the further away they are from the edge</li>
                        <li>Boundaries are drawn at the point where the valleys would fuse if they were filled with water</li>
                        <li>Several variants of this algorithm exist </li>
                    </ul></ul><ul>
                <br><img class="img-responsive" src="../docs/assets/Images/ImageJ/Page 4/figure-watershed.png" alt="">
                Image copied from <a>https://imagej.net/plugins/interactive-watershed</a>
                <br>  <br>

                    
                    <li>Many standard binary image procesing tools can be found in Process > Binary </li>
                    <ul>
                        <li>These include a basic version of <b>"Watershed"</b>. Try it out</li>
                        <li>That's a bit better. Other variants can be found and installed if you want to explore further e.g. <a>https://imagej.net/plugins/morpholibj</a>, and <a>"https://imagej.net/plugins/interactive-watershed"</a></li>
                    </ul>                                   
                </ul>
                <br><p float="left">
                      <img src="../docs/assets/Images/ImageJ/Page 4/blobs- basic watershed.jpg" width="48%" />
                      <img src="../docs/assets/Images/ImageJ/Page 4/blobs- basic watershed AP result.jpg" width="48%" />
                    </p><br>
                    
                <h3>Set Measurements</h3>
                <br>
                The measurements calculated in Analyze Particles are determined within "Set Measurements". 
                <p></p>
                <b>Exercise 3:</b> 
                <ul>
                  <li>Go to your downloaded material and open "DAPI.tif" from "Images"</li>
                  <li>We are going to try to automate the following process, so keep the recorder open to help with this</l>
                  <li>Threshold this image to try to segment the DAPI-stained nuclei</li>
                  <li>Can you use any binary operations (e.g. watershedding) to optimise the segmentation?</li>
                  <li>Modify the measurements in "Set Measurements" to calculate the centroid of each particle analysed</li>
                      <br>
                  <li>Try to write a macro to perform the entire segmentation task</li>
                  <li>Click <a href="../docs/assets/Help pages/ImageJ/Page 4/Help automating thresholding 1.html" >here</a> for help with this</l>
                    </ul>

                <h3>Machine Learning</h3>
                <br>
                Impressive machine learning tools are being developed which can be very useful for bioimage segmentation.
                <p>These include <a href=https://imagej.net/plugins/stardist>Stardist</a> and <a href="https://www.cellpose.org/">CellPose</a>. </p>
                <p></p>
                <b>Exercise 4:</b> 
                <ul>
                  <li>We're going to use Stardist to segment crowded nuclei.</l>
                  <li>Necessary plugins must first be installed. </l>
                  <li>Help > Update > Manage update sites </li>
                    <ul><li>Select <b>CSB Deep</b> and <b>Stardist</b> (to perform segmentation)</li>
                      <li>Select <b>SCF MPI CBG</b> and <b>IJPB-plugins</b> (for labelmap processing and analysis)</li>
                      <li>Apply changes, then restart Fiji</li>
                    </ul>
                  <li>Open the same "DAPI.tif" image used previously</li>
                  <li>Open Stardist (Plugins > Stardist > Stardist 2D)</li>
                  <li>Run using default settings (brace yourself!)</li>
                  <li>If you like, try segmenting traditionally for comparison.</li>
                  <li>Stardist will work very well for somethings but not everything, so knowing the fundamentals is still valuable... for now.</li>
                  <li>The output is a labelmap, not a binary image. This does not work with Analyze Particles.</li>
                  <li>Alternatively use Plugins > MorpholibJ > Analyze > Analyze Regions</li>
                  <li>If you wanted to look at signal intensties use Plugins > MorpholibJ > Analyze > Intensity Measurements 2D/3D</li>
                  <li><mark><b>Note</b>. We haven't used the SCF MPI CBG plugin yet. This appears as "SCF" in Fiji, 
                    and is very useful for creating and manipulating labelmaps, as well as adding more watershedding functions. </mark></li>
                    </ul>

    

                    <br>
                  <br>
                  <a href="../imagej.html">Home</a> | <a href="ImageJ_pg3.html"> << Previous Page</a> | <a href="ImageJ_pg5.html"> Next Page >></a> 





                </div>
            </div> 

            <!-- Contact Info on the Sidebar -->
            
            <!-- Publications -->
            
        </div>


    </div>
    <!-- /.container -->
    
    
</body>




</html>
